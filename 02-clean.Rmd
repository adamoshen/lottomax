---
title: "Cleaning LottoMax data"
author: "Adam Shen"
date: "June 22, 2021"
output: 
  html_document:
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
    highlight: tango
    theme:
      bootswatch: cosmo
      base_font:
        google: "IBM Plex Sans"
      code_font:
        google: "IBM Plex Mono"
pandoc_args: "-smart"
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
```

# Packages

```{r}
library(tidyverse)
library(lubridate)
```

# Load the data

```{r}
lottomax <- readRDS("./data/lottomax.RDS")

lottomax

as.character(lottomax[1,2])

as.character(lottomax[1,3])
```

# Clean the data

To do:

- `date`: remove the non-space characters and the "With Max Millions!" phrase
- Need to filter to only include dates after May 14, 2019 (inclusive) since LottoMax
was changed to now have 50 possible numbers instead of 49
- `result`: remove the non-space characters and reformat this column somehow so
that the numbers are a easy to access and manipulate
- Remember that the last number is a "bonus" number
- Preferable to sort data too

```{r}
lottomax %>%
  # Convert `year` to factor
  mutate(across(year, as.factor)) %>%
  # Repair `date` to be an actual date
  mutate(
    # Remove excessive whitespace from `date` column
    date = str_squish(date),
    # Remove extra text
    date = str_remove(date, pattern="With Max Millions!"),
    # Parse date text in mm/dd/yyyy format
    date = mdy(date)
  ) %>%
  # Keep only rows that were drawn after May 14, 2019 (inclusive)
  filter(date >= mdy("May 14 2019")) %>%
  # Remove excessive whitespace from `result` column
  mutate(result = str_squish(result)) %>%

  
  # Do I actually want to make 7+1 columns or keep it 1+1...
  
  # Separate the regular numbers from the bonus numbers
  # Set `remove=FALSE` to check if we did it correctly
  separate(result, into=c("nums", "bonus"), sep=-2, remove=FALSE) %>%
  # Conversion of strings to numbers that we can work with
  mutate(
    across(bonus, parse_integer)
  )
```



















# Session info

```{r, echo=FALSE}
sessioninfo::package_info(
  pkgs = c("lubridate"),
  dependencies = FALSE
)
```


```{r, eval=FALSE, include=FALSE}
rmarkdown::render("02-clean.Rmd", output_dir="./output")
```
